<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>ChainStore Menus</title>
<style>
	#map {
	  width: 800px;
	  height: 600px;
	  border: 1px solid #999;
	}
</style>
</head>
<body>
	<h3>検索欄</h3>
	<form action="/chainstoremenus/search" method="get">
		<label>キーワード<input type="text" name="keyword"></label><br>
		<label>場所<input type="text" name="center"></label><br>
		<label>範囲<input type="number" name="radius"></label>
		<input type="submit" value="検索">
	</form>
	<div id="map"></div>

	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBvngfDlCJ3HuSMFjB0jylBTpowN9pb-RQ&callback=initMap" async defer></script>
	<script>
		function initMap() {
			// #TODO: 現在地を取得して代入する
			let request = {
				center: {lat: 35.681236, lng: 139.767125},
				zoom: 15
			};
			let map = new google.maps.Map(document.getElementById('map'), request);
		
			let directionsService = new google.maps.DirectionsService();
			let directionsRenderer = new google.maps.DirectionsRenderer();
			directionsRenderer.setMap(map);
		
			calculateAndDisplayRoute(directionsService, directionsRenderer);
		}
	  
		function calculateAndDisplayRoute(directionsService, directionsRenderer) {
			// #TODO: 現在地と目的地を緯度経度で渡す
			let request = {
				origin: {lat: 35.681236, lng: 139.767125},
				destination: {query: '秋葉原駅'},
				travelMode: 'WALKING'
			};
			directionsService.route(request,	
			function(response, status) {
				if (status === 'OK') {
					directionsRenderer.setDirections(response);
				} else {
					alert('Directions request failed due to ' + status);
				}
			});
		}
	</script>
</body>
</html>